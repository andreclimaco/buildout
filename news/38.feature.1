Support Python 3.12 and 3.13.
This only needed a few test fixes.
Tested with Python 3.13.0rc3.
[maurits]
